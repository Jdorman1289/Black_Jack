# name: Build KivyMD App

# on: [push]

# jobs:
#   build:
#     runs-on: ubuntu-latest
#     steps:
#     - uses: actions/checkout@v4

#     - name: Set up Python
#       uses: actions/setup-python@v5
#       with:
#         python-version: '3.11'
  
#     - name: Clear cache
#       run: 
#         rm -rf ~/.buildozer

#     - name: Install dependencies
#       run: |
#         sudo apt update
#         sudo apt install -y git zip unzip openjdk-8-jdk python3-pip autoconf libtool pkg-config zlib1g-dev libncurses5-dev libncursesw5-dev libtinfo5 cmake libffi-dev libssl-dev
#         pip install --upgrade Cython==0.29.19 virtualenv
#         pip install buildozer

#     - name: Setup Android SDK Tools
#       uses: android-actions/setup-android@v3.2.1
#       with:
#         cmdline-tools-version: latest
#         packages: 'build-tools;35.0.0-rc4'
  
#     - name: Build APK
#       run: |
#         buildozer init
#         sed -i 's/^requirements = python3,kivy$/requirements = python3,kivy,kivymd,pillow/' buildozer.spec
#         buildozer -v android debug

    # - name: Upload APK
    #   uses: actions/upload-artifact@v4
    #   with:
    #     name: apk
    #     path: bin/*.apk

name: Build
on: [push, pull_request]

jobs:
  build-android:
    name: Build for Android
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v2

      - name: Build with Buildozer
        uses: ArtemSBulgakov/buildozer-action@v1
        id: buildozer
        with:
          workdir: ~/
          buildozer_version: stable

      - name: Upload APK
        uses: actions/upload-artifact@v4
        with:
          name: apk
          path: bin/*.apk